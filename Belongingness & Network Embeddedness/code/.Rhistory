#Convert to Matrices
sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)
# Convert matrix to an igraph object
g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates
#Capture Roles, Nights & Colors
temp_att <- temp_att %>%
mutate(
role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
)
#Add staff Role Attribute
V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)]
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)]
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)]
#Add role colors
V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)]
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)]
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]
#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.
w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 1) #Match Weights
g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 2) #Match weights
g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 3) #Match weights
g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 4) #Match weights
g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 5) #Match weights
g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute
#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)
rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
tuesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
temp_night <- temp            %>% filter(night == "wednesday")
temp_att   <- staff_youth_att %>% mutate(night =  "wednesday")
#Surv_1
surv_1 <- temp_night %>%
filter(survnum == 1) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates1 <- surv_1 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_1 <- surv_1 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 2
surv_2 <- temp_night %>%
filter(survnum == 2) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates2 <- surv_2 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_2 <- surv_2 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 3
surv_3 <- temp_night %>%
filter(survnum == 3) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates3 <- surv_3 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_3 <- surv_3 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 4
surv_4 <- temp_night %>%
filter(survnum == 4) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates4 <- surv_4 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_4 <- surv_4 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 5
surv_5 <- temp_night %>%
filter(survnum == 5) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates5 <- surv_5 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_5 <- surv_5 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
day <- list(sur1 = surv_1,
sur2 = surv_2,
sur3 = surv_3,
sur4 = surv_4,
sur5 = surv_5,
iso1 = isolates1,
iso2 = isolates2,
iso3 = isolates3,
iso4 = isolates4,
iso5 = isolates5)
rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)
#Convert to Matrices
sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)
# Convert matrix to an igraph object
g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates
#Capture Roles, Nights & Colors
temp_att <- temp_att %>%
mutate(
role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
)
#Add staff Role Attribute
V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)]
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)]
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)]
#Add role colors
V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)]
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)]
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]
#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.
w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 1) #Match Weights
g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 2) #Match weights
g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 3) #Match weights
g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 4) #Match weights
g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 5) #Match weights
g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute
#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)
rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
wednesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
temp_night <- temp            %>% filter(night == "thursday")
temp_att   <- staff_youth_att %>% mutate(night =  "thursday")
#Surv_1
surv_1 <- temp_night %>%
filter(survnum == 1) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates1 <- surv_1 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_1 <- surv_1 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 2
surv_2 <- temp_night %>%
filter(survnum == 2) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates2 <- surv_2 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_2 <- surv_2 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 3
surv_3 <- temp_night %>%
filter(survnum == 3) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates3 <- surv_3 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_3 <- surv_3 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 4
surv_4 <- temp_night %>%
filter(survnum == 4) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates4 <- surv_4 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_4 <- surv_4 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 5
surv_5 <- temp_night %>%
filter(survnum == 5) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates5 <- surv_5 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_5 <- surv_5 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
day <- list(sur1 = surv_1,
sur2 = surv_2,
sur3 = surv_3,
sur4 = surv_4,
sur5 = surv_5,
iso1 = isolates1,
iso2 = isolates2,
iso3 = isolates3,
iso4 = isolates4,
iso5 = isolates5)
rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)
#Convert to Matrices
sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)
# Convert matrix to an igraph object
g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates
#Capture Roles, Nights & Colors
temp_att <- temp_att %>%
mutate(
role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
)
#Add staff Role Attribute
V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)]
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)]
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)]
#Add role colors
V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)]
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)]
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]
#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.
w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 1) #Match Weights
g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 2) #Match weights
g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 3) #Match weights
g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 4) #Match weights
g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 5) #Match weights
g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute
#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)
rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
thursday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
#Set chart image
par(mfrow=c(4,5))
#Monday Graphs
my_sn_g(monday$graphs$g1,      title = "Monday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(monday$graphs$g2,      title = "Monday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(monday$graphs$g3,      title = "Monday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(monday$graphs$g4,      title = "Monday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(monday$graphs$g5,      title = "Monday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
#Tuesday Graphs
my_sn_g(tuesday$graphs$g1,     title = "Tuesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g2,     title = "Tuesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g3,     title = "Tuesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g4,     title = "Tuesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g5,     title = "Tuesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
#Wednesday Graphs
my_sn_g(wednesday$graphs$g1,   title = "Wednesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g2,   title = "Wednesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g3,   title = "Wednesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g4,   title = "Wednesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g5,   title = "Wednesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g1,    title = "Thursday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g2,    title = "Thursday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g3,    title = "Thursday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g4,    title = "Thursday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g5,    title = "Thursday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
#Plot With purrr::walk()
#walk(.x = monday$graphs, .f = my_sn_g, title = "Monday");my_leg(role, color)
#walk(.x = tuesday$graphs, .f = my_sn_g, title = "Tuesday");my_leg(role, color)
#walk(.x =wednesday$graphs, .f = my_sn_g, title = "Wednesday");my_leg(role, color)
#walk(.x = thursday$graphs, .f = my_sn_g, title = "Thursday");my_leg(role, color)
F15 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(temp)
temp <- elmk %>% filter(semester == "S16")
mon <- temp %>% filter(night == "monday")
tue <- temp %>% filter(night == "tuesday")
wed <- temp %>% filter(night == "wednesday")
thu <- temp %>% filter(night == "thursday")
sem <- list(mon = mon,
tue = tue,
wed = wed,
thu = thu)
rm(mon);rm(tue);rm(wed);rm(thu)
sem$mon <- group_by(sem$mon, survnum)
sem$tue <- group_by(sem$tue, survnum)
sem$wed <- group_by(sem$wed, survnum)
sem$thu <- group_by(sem$thu, survnum)
summarize(sem$mon, day = "mon", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$mon))*100)
summarize(sem$tue, day = "tue", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$tue))*100)
summarize(sem$wed, day = "wed", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$wed))*100)
summarize(sem$thu, day = "thu", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$thu))*100)
sem$mon <- ungroup(sem$mon)
sem$tue <- ungroup(sem$tue)
sem$wed <- ungroup(sem$wed)
sem$thu <- ungroup(sem$thu)
rm(sem)
temp_night <- temp            %>% filter(night == "monday")
temp_att   <- staff_youth_att %>% mutate(night =  "monday")
#Surv_1
surv_1 <- temp_night %>%
filter(survnum == 1) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates1 <- surv_1 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_1 <- surv_1 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 2
surv_2 <- temp_night %>%
filter(survnum == 2) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates2 <- surv_2 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_2 <- surv_2 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 3
surv_3 <- temp_night %>%
filter(survnum == 3) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates3 <- surv_3 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_3 <- surv_3 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 4
surv_4 <- temp_night %>%
filter(survnum == 4) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates4 <- surv_4 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_4 <- surv_4 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 5
surv_5 <- temp_night %>%
filter(survnum == 5) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates5 <- surv_5 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_5 <- surv_5 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
day <- list(sur1 = surv_1,
sur2 = surv_2,
sur3 = surv_3,
sur4 = surv_4,
sur5 = surv_5,
iso1 = isolates1,
iso2 = isolates2,
iso3 = isolates3,
iso4 = isolates4,
iso5 = isolates5)
rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)
#Convert to Matrices
sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)
# Convert matrix to an igraph object
g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates
#Capture Roles, Nights & Colors
temp_att <- temp_att %>%
mutate(
role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
)
#Add staff Role Attribute
V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)]
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)]
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)]
#Add role colors
V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)]
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)]
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]
#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.
w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 1) #Match Weights
g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 2) #Match weights
g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 3) #Match weights
g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 4) #Match weights
g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute
w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>%
filter(survnum == 5) #Match weights
g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute
#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)
rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
monday <- list(edgelists = day, graphs = graphs)
rm(day);rm(graphs)
library(threejs)
View(F15)
graphjs(F15$monday$graphs$g1)
