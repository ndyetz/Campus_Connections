surv_3 <- surv_3 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 4
surv_4 <- temp_night %>%
filter(survnum == 4) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates4 <- surv_4 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_4 <- surv_4 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
#Surv 5
surv_5 <- temp_night %>%
filter(survnum == 5) %>%
mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>%
#Getting isolates
isolates5 <- surv_5 %>%
mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>%
group_by(Sender_Final_ID) %>%
summarize(isolate = sum(sn1)) %>%
filter(isolate < 1) %>%
select(Sender_Final_ID)
surv_5 <- surv_5 %>%
select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))
day <- list(sur1 = surv_1,
sur2 = surv_2,
sur3 = surv_3,
sur4 = surv_4,
sur5 = surv_5,
iso1 = isolates1,
iso2 = isolates2,
iso3 = isolates3,
iso4 = isolates4,
iso5 = isolates5)
rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)
rm(temp_night)
sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)
# Convert friends matrix to an igraph object
g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates
#Add staff Role Attribute
V(g1)$role  <- staff_youth_att$role1[match(V(g1)$name, staff_youth_att$Final_ID)]
V(g2)$role  <- staff_youth_att$role1[match(V(g2)$name, staff_youth_att$Final_ID)]
V(g3)$role  <- staff_youth_att$role1[match(V(g3)$name, staff_youth_att$Final_ID)]
V(g4)$role  <- staff_youth_att$role1[match(V(g4)$name, staff_youth_att$Final_ID)]
V(g5)$role  <- staff_youth_att$role1[match(V(g5)$name, staff_youth_att$Final_ID)]
#Add role colors
V(g1)$color <- staff_youth_att$role_col[match(V(g1)$name, staff_youth_att$Final_ID)]
V(g2)$color <- staff_youth_att$role_col[match(V(g2)$name, staff_youth_att$Final_ID)]
V(g3)$color <- staff_youth_att$role_col[match(V(g3)$name, staff_youth_att$Final_ID)]
V(g4)$color <- staff_youth_att$role_col[match(V(g4)$name, staff_youth_att$Final_ID)]
V(g5)$color <- staff_youth_att$role_col[match(V(g5)$name, staff_youth_att$Final_ID)]
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)
#For Legend roles & corresponding colors
role <-  c("mentee", "mentor", "mentor coach", "lead mentor coach", "instructor")
color <- c("orange","green","dodgerblue", "red", "grey50")
rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
thursday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
par(mfrow=c(5,4)) # To plot two plots side-by-side
my_sn_g(monday$graphs$g1,      title = "Monday - Week 1");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g1,     title = "Tuesday - Week 1");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g1,   title = "Wednesday - Week 1");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g1,    title = "Thursday - Week 1");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(monday$graphs$g2,      title = "Monday - Week 3");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g2,     title = "Tuesday - Week 3");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g2,   title = "Wednesday - Week 3");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g2,    title = "Thursday - Week 3");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(monday$graphs$g3,      title = "Monday - Week 6");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g3,     title = "Tuesday - Week 6");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g3,   title = "Wednesday - Week 6");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g3,    title = "Thursday - Week 6");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(monday$graphs$g4,      title = "Monday - Week 9");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g4,     title = "Tuesday - Week 9");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g4,   title = "Wednesday - Week 9");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g4,    title = "Thursday - Week 9");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(monday$graphs$g5,      title = "Monday - Week 11");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(tuesday$graphs$g5,     title = "Tuesday - Week 11");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(wednesday$graphs$g5,   title = "Wednesday - Week 11");my_leg(att = role, colors = color) #Social Network Graph ; Legend
my_sn_g(thursday$graphs$g5,    title = "Thursday - Week 11");my_leg(att = role, colors = color) #Social Network Graph ; Legend
S17 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(temp)
ALL <- list(F15 = F15, S16 = S16, F16 = F16, S17 = S17)
rm(F15);rm(S16);rm(F16);rm(S17)
#Monday
g1 <- ALL$F15$monday$graphs$g1
g2 <- ALL$F15$monday$graphs$g2
g3 <- ALL$F15$monday$graphs$g3
g4 <- ALL$F15$monday$graphs$g4
g5 <- ALL$F15$monday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
monday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Tuesday
g1 <- ALL$F15$tuesday$graphs$g1
g2 <- ALL$F15$tuesday$graphs$g2
g3 <- ALL$F15$tuesday$graphs$g3
g4 <- ALL$F15$tuesday$graphs$g4
g5 <- ALL$F15$tuesday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
tuesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Wednesday
g1 <- ALL$F15$wednesday$graphs$g1
g2 <- ALL$F15$wednesday$graphs$g2
g3 <- ALL$F15$wednesday$graphs$g3
g4 <- ALL$F15$wednesday$graphs$g4
g5 <- ALL$F15$wednesday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
wednesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Thursday
g1 <- ALL$F15$thursday$graphs$g1
g2 <- ALL$F15$thursday$graphs$g2
g3 <- ALL$F15$thursday$graphs$g3
g4 <- ALL$F15$thursday$graphs$g4
g5 <- ALL$F15$thursday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
thursday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
par(mfrow=c(5,4))
plot(monday$surv1, main =    "week 1 - Monday")
plot(tuesday$surv1, main =   "week 1 - Tuesday")
plot(wednesday$surv1, main = "week 1 - Wednesday")
plot(thursday$surv1, main =  "week 1 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv2, main =    "week 3 - Monday")
plot(tuesday$surv2, main =   "week 3 - Tuesday")
plot(wednesday$surv2, main = "week 3 - Wednesday")
plot(thursday$surv2, main =  "week 3 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv3, main =    "week 6 - Monday")
plot(tuesday$surv3, main =   "week 6 - Tuesday")
plot(wednesday$surv3, main = "week 6 - Wednesday")
plot(thursday$surv3, main =  "week 6 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv4, main =    "week 9 - Monday")
plot(tuesday$surv4, main =   "week 9 - Tuesday")
plot(wednesday$surv4, main = "week 9 - Wednesday")
plot(thursday$surv4, main =  "week 9 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv5, main =    "week 11 - Monday")
plot(tuesday$surv5, main =   "week 11 - Tuesday")
plot(wednesday$surv5, main = "week 11 - Wednesday")
plot(thursday$surv5, main =  "week 11 -Thursday")
F15 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
#Monday
g1 <- ALL$S16$monday$graphs$g1
g2 <- ALL$S16$monday$graphs$g2
g3 <- ALL$S16$monday$graphs$g3
g4 <- ALL$S16$monday$graphs$g4
g5 <- ALL$S16$monday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
monday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Tuesday
g1 <- ALL$S16$tuesday$graphs$g1
g2 <- ALL$S16$tuesday$graphs$g2
g3 <- ALL$S16$tuesday$graphs$g3
g4 <- ALL$S16$tuesday$graphs$g4
g5 <- ALL$S16$tuesday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
tuesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Wednesday
g1 <- ALL$S16$wednesday$graphs$g1
g2 <- ALL$S16$wednesday$graphs$g2
g3 <- ALL$S16$wednesday$graphs$g3
g4 <- ALL$S16$wednesday$graphs$g4
g5 <- ALL$S16$wednesday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
wednesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Thursday
g1 <- ALL$S16$thursday$graphs$g1
g2 <- ALL$S16$thursday$graphs$g2
g3 <- ALL$S16$thursday$graphs$g3
g4 <- ALL$S16$thursday$graphs$g4
g5 <- ALL$S16$thursday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
thursday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
par(mfrow=c(5,4))
plot(monday$surv1, main =    "week 1 - Monday")
plot(tuesday$surv1, main =   "week 1 - Tuesday")
plot(wednesday$surv1, main = "week 1 - Wednesday")
plot(thursday$surv1, main =  "week 1 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv2, main =    "week 3 - Monday")
plot(tuesday$surv2, main =   "week 3 - Tuesday")
plot(wednesday$surv2, main = "week 3 - Wednesday")
plot(thursday$surv2, main =  "week 3 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv3, main =    "week 6 - Monday")
plot(tuesday$surv3, main =   "week 6 - Tuesday")
plot(wednesday$surv3, main = "week 6 - Wednesday")
plot(thursday$surv3, main =  "week 6 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv4, main =    "week 9 - Monday")
plot(tuesday$surv4, main =   "week 9 - Tuesday")
plot(wednesday$surv4, main = "week 9 - Wednesday")
plot(thursday$surv4, main =  "week 9 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv5, main =    "week 11 - Monday")
plot(tuesday$surv5, main =   "week 11 - Tuesday")
plot(wednesday$surv5, main = "week 11 - Wednesday")
plot(thursday$surv5, main =  "week 11 -Thursday")
S16<- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
#Monday
g1 <- ALL$F16$monday$graphs$g1
g2 <- ALL$F16$monday$graphs$g2
g3 <- ALL$F16$monday$graphs$g3
g4 <- ALL$F16$monday$graphs$g4
g5 <- ALL$F16$monday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
monday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Tuesday
g1 <- ALL$F16$tuesday$graphs$g1
g2 <- ALL$F16$tuesday$graphs$g2
g3 <- ALL$F16$tuesday$graphs$g3
g4 <- ALL$F16$tuesday$graphs$g4
g5 <- ALL$F16$tuesday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
tuesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Wednesday
g1 <- ALL$F16$wednesday$graphs$g1
g2 <- ALL$F16$wednesday$graphs$g2
g3 <- ALL$F16$wednesday$graphs$g3
g4 <- ALL$F16$wednesday$graphs$g4
g5 <- ALL$F16$wednesday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
wednesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Thursday
g1 <- ALL$F16$thursday$graphs$g1
g2 <- ALL$F16$thursday$graphs$g2
g3 <- ALL$F16$thursday$graphs$g3
g4 <- ALL$F16$thursday$graphs$g4
g5 <- ALL$F16$thursday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
thursday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
par(mfrow=c(5,4))
plot(monday$surv1, main =    "week 1 - Monday")
plot(tuesday$surv1, main =   "week 1 - Tuesday")
plot(wednesday$surv1, main = "week 1 - Wednesday")
plot(thursday$surv1, main =  "week 1 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv2, main =    "week 3 - Monday")
plot(tuesday$surv2, main =   "week 3 - Tuesday")
plot(wednesday$surv2, main = "week 3 - Wednesday")
plot(thursday$surv2, main =  "week 3 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv3, main =    "week 6 - Monday")
plot(tuesday$surv3, main =   "week 6 - Tuesday")
plot(wednesday$surv3, main = "week 6 - Wednesday")
plot(thursday$surv3, main =  "week 6 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv4, main =    "week 9 - Monday")
plot(tuesday$surv4, main =   "week 9 - Tuesday")
plot(wednesday$surv4, main = "week 9 - Wednesday")
plot(thursday$surv4, main =  "week 9 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv5, main =    "week 11 - Monday")
plot(tuesday$surv5, main =   "week 11 - Tuesday")
plot(wednesday$surv5, main = "week 11 - Wednesday")
plot(thursday$surv5, main =  "week 11 -Thursday")
F16 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
#Monday
g1 <- ALL$S17$monday$graphs$g1
g2 <- ALL$S17$monday$graphs$g2
g3 <- ALL$S17$monday$graphs$g3
g4 <- ALL$S17$monday$graphs$g4
g5 <- ALL$S17$monday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
monday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Tuesday
g1 <- ALL$S17$tuesday$graphs$g1
g2 <- ALL$S17$tuesday$graphs$g2
g3 <- ALL$S17$tuesday$graphs$g3
g4 <- ALL$S17$tuesday$graphs$g4
g5 <- ALL$S17$tuesday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
tuesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Wednesday
g1 <- ALL$S17$wednesday$graphs$g1
g2 <- ALL$S17$wednesday$graphs$g2
g3 <- ALL$S17$wednesday$graphs$g3
g4 <- ALL$S17$wednesday$graphs$g4
g5 <- ALL$S17$wednesday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
wednesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
#Thursday
g1 <- ALL$S17$thursday$graphs$g1
g2 <- ALL$S17$thursday$graphs$g2
g3 <- ALL$S17$thursday$graphs$g3
g4 <- ALL$S17$thursday$graphs$g4
g5 <- ALL$S17$thursday$graphs$g5
lc1 <- largest_cliques(g1)
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))
lc1 <- largest_cliques(g2)
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))
lc1 <- largest_cliques(g3)
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))
lc1 <- largest_cliques(g4)
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))
lc1 <- largest_cliques(g5)
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))
thursday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)
rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)
par(mfrow=c(5,4))
plot(monday$surv1, main =    "week 1 - Monday")
plot(tuesday$surv1, main =   "week 1 - Tuesday")
plot(wednesday$surv1, main = "week 1 - Wednesday")
plot(thursday$surv1, main =  "week 1 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv2, main =    "week 3 - Monday")
plot(tuesday$surv2, main =   "week 3 - Tuesday")
plot(wednesday$surv2, main = "week 3 - Wednesday")
plot(thursday$surv2, main =  "week 3 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv3, main =    "week 6 - Monday")
plot(tuesday$surv3, main =   "week 6 - Tuesday")
plot(wednesday$surv3, main = "week 6 - Wednesday")
plot(thursday$surv3, main =  "week 6 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv4, main =    "week 9 - Monday")
plot(tuesday$surv4, main =   "week 9 - Tuesday")
plot(wednesday$surv4, main = "week 9 - Wednesday")
plot(thursday$surv4, main =  "week 9 -Thursday")
#par(mfrow=c(4,1))
plot(monday$surv5, main =    "week 11 - Monday")
plot(tuesday$surv5, main =   "week 11 - Tuesday")
plot(wednesday$surv5, main = "week 11 - Wednesday")
plot(thursday$surv5, main =  "week 11 -Thursday")
S17 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
cliques <- list(F15 = F15, S16 = S16, F16 = F16, S17 = S17)
rm(F15);rm(S16);rm(F16);rm(S17)
