---
title: "R Notebook for Network & belongingness Paper"
output:
  html_notebook:
    toc: yes
    toc_float:
      collapsed: yes
    code_folding: hide
  html_document:
    df_print: paged
    toc: yes
    toc_float:
      collapsed: yes
  pdf_document:
    toc: yes
author: By Neil Yetz, MPH
---
<center>
![](http://www.hdfs.chhs.colostate.edu/students/undergraduate/campusconnections/images/302671_CampusConnections-logo.png)
</center>

#Introduction
This Document was last updated on `r format(Sys.time(), "%B %d, %Y")`. This document is associated with the [Campus Connections](http://www.hdfs.chhs.colostate.edu/students/undergraduate/campusconnections/) Social Network Data. Please set the correct working directories in the [setwd & load data](#ref) section of this notebook. When run successfully, all network graphs, separated by semester and night with role attributes will be outputted and saved as a .RDS file into the MERGEALL folder of WTG. If you have any questions concerning this document, please send an email to Neil Yetz at <neil.yetz@colostate.edu>.


#Check for errors here.
```{r}
#SOurce code for problem isolates
#source("S:/Git/Campus_Connections/Belongingness & Network Embeddedness/code/Iso_source.R")
```

#Load Libraries
```{r, message = FALSE}

#install.packages("CTT")
#install.packages("GGally")
#install.packages("ggplot2")
#install.packages("lattice")
#install.packages("gridExtra")
#install.packages("igraph")
#install.packages("dplyr")
#install.packages("tidyr")
#install.packages("igraph")
#install.packages("statnet")
#install.packages("ggthemes")

library(CTT)
library(GGally)
library(ggplot2)
library(lattice)
library(gridExtra)
library(reshape)
library(igraph)
library(tidyverse)
library(ggthemes)
```

#setwd & load data {#ref}
```{r, message = FALSE, warning = FALSE}
setwd("T:/Research folders/CCWTG/Analyses/Data for Stats Dept/FINAL DATA")

#elmk <- read_csv("CC_edgelist.csv") 
#saveRDS(elmk,"cc_edgelist.rds")
elmk <- readRDS("cc_edgelist.rds")
youth_att <- read_csv("Mentee_Attributes.csv")
staff_att <- read_csv("Staff_Attributes_Final.csv")
```

#Format Edgelist
```{r}
elmk <- elmk %>% 
  filter(Receiver_Missing == 0,
         Sender_missing == 0, 
         Sender_Final_ID != Receiver_Final_ID) %>% 
  mutate(sn1 = ifelse((sn1 == 1 & sn2 == 0), NA, sn1), #marking NA for nominated, but weight = 0
         sn2 = ifelse(is.na(sn1), NA, sn2)) %>% 
  select(-Receiver_Missing, -Sender_missing)
```

#Format Attributes
```{r}

youth_att <- youth_att %>% 
  mutate(Final_ID = final_ID, 
         role1 = Role, 
         night1 = tolower(night),
         night2 =NA,
         role2 = NA,
         mentee = NA
         ) %>% 
  select(Final_ID, semester, night1, night2, mfcond, role1, role2, room, gender, mentee, impnotes, date_dropped, no_start)

staff_att <- staff_att %>% 
  mutate(date_dropped = NA,
         no_start = NA,
         Final_ID = FInal_ID) %>%  
  select(Final_ID, semester, night1, night2, mfcond, role1, role2, room, gender, mentee, impnotes, date_dropped, no_start)

staff_youth_att <- rbind(staff_att, youth_att)

#Mentors that did NOT consent to survey research but DID consent to social Network (separate consent process).
sn_consent <- staff_youth_att %>% 
  filter(is.na(role1) | is.na(night1) & role1 != "mentee")
sn_consent <- as.vector(sn_consent$Final_ID)

#Set night & role of non-consent survey but consent Social Network.
staff_youth_att <- staff_youth_att %>% 
  mutate(
        night1 = ifelse(Final_ID == sn_consent[1], "tuesday", night1), role1  = ifelse(Final_ID == sn_consent[1], "mentor",  role1),
        night1 = ifelse(Final_ID == sn_consent[2], "tuesday", night1), role1  = ifelse(Final_ID == sn_consent[2], "mentor",  role1),
        night1 = ifelse(Final_ID == sn_consent[3], "tuesday", night1), role1  = ifelse(Final_ID == sn_consent[3], "mentor",  role1)
         )

#Check sn_consent status again - Should be 0 rows
#staff_youth_att %>% 
#  filter(is.na(role1) | is.na(night1) & role1 != "mentee")

staff_youth_att <- staff_youth_att %>% 
    #lowercase all
  mutate(role1 = tolower(role1),
         role2 = tolower(role2),
         night1 = tolower(night1),
         night2 = tolower(night2),
         #Set role colors
         role_col = ifelse(role1 == "mentee", "orange", NA),
         role_col = ifelse(role1 == "mentor", "green", role_col),
         role_col = ifelse(role1 == "mentor coach", "dodgerblue", role_col),
         role_col = ifelse(role1 == "lead mentor coach", "red", role_col),
         role_col = ifelse(role1 == "instructor", "grey50", role_col),
         
         role_col2 = ifelse(role2 == "mentee", "orange", NA),
         role_col2 = ifelse(role2 == "mentor", "green", role_col2),
         role_col2 = ifelse(role2 == "mentor coach", "dodgerblue", role_col2),
         role_col2 = ifelse(role2 == "lead mentor coach", "red", role_col2),
         role_col2 = ifelse(role2 == "instructor", "grey50", role_col2)
         )

rm(sn_consent)

```


#Create Useful Functions
```{r}


#use this function to create plots Adjust here if necessary.
my_sn_g <- function(g, title = "", vertex.label = NA, vertex.size = 10, edge.color = "black", edge.arrow.size = 0.3 ,edge.width = (E(g)$weight / 4), layout = layout_nicely){
  plot(g,
     vertex.label = NA, 
     vertex.size = 10,
     edge.color = 'black',
     edge.arrow.size = .3,
     edge.width = (E(g)$weight / 4),
     layout = layout_nicely(g), 
     main = title) 
} 



#function to make legend creation cleaner
#Create vectors of attributes colors & corresponding colors
my_leg <- function(att, colors) {
  legend("bottomright", legend=att  , col = colors , bty = "o", pch=20 , pt.cex = 1, cex = 1, text.col= color , horiz = FALSE, inset = c(-0.06, 0))
}

```

#Set Legend
```{r}
#For Legend roles & corresponding colors
role <-  c("mentee", "mentor", "mentor coach", "lead mentor coach", "instructor") 
color <- c("orange","green","dodgerblue", "red", "grey50")
```

#Create General Graphs
##F15
```{r}
temp <- elmk %>% filter(semester == "F15")

mon <- temp %>% filter(night == "monday")
tue <- temp %>% filter(night == "tuesday")
wed <- temp %>% filter(night == "wednesday")
thu <- temp %>% filter(night == "thursday")

sem <- list(mon = mon, 
            tue = tue, 
            wed = wed, 
            thu = thu)

rm(mon);rm(tue);rm(wed);rm(thu)


```

**Summary**
```{r}


sem$mon <- group_by(sem$mon, survnum)
sem$tue <- group_by(sem$tue, survnum)
sem$wed <- group_by(sem$wed, survnum)
sem$thu <- group_by(sem$thu, survnum)

summarize(sem$mon, day = "mon", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$mon))*100)
summarize(sem$tue, day = "tue", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$tue))*100)
summarize(sem$wed, day = "wed", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$wed))*100)
summarize(sem$thu, day = "thu", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$thu))*100)

sem$mon <- ungroup(sem$mon)
sem$tue <- ungroup(sem$tue)
sem$wed <- ungroup(sem$wed)
sem$thu <- ungroup(sem$thu)

rm(sem)
```

**Monday**
```{r}
#Set to right days
temp_night <- temp            %>% filter(night == "monday")
temp_att   <- staff_youth_att %>% mutate(night =  "monday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)
```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)





rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create Monday List**
```{r}
monday <- list(edgelists = day, graphs = graphs)
rm(day);rm(graphs)
```


**Tuesday**
```{r}

temp_night <- temp            %>% filter(night == "tuesday")
temp_att   <- staff_youth_att %>% mutate(night =  "tuesday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)





rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
tuesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


**Wednesday**
```{r}

temp_night <- temp            %>% filter(night == "wednesday")
temp_att   <- staff_youth_att %>% mutate(night =  "wednesday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
wednesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


**Thursday**
```{r}

temp_night <- temp            %>% filter(night == "thursday")
temp_att   <- staff_youth_att %>% mutate(night =  "thursday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```


**Create List**
```{r}
thursday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```

###Plot Graphs
```{r, warning = FALSE, fig.width = 20, fig.height=20}

#Set chart image
par(mfrow=c(4,5)) 

#Monday Graphs

   my_sn_g(monday$graphs$g1,      title = "Monday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
   my_sn_g(monday$graphs$g2,      title = "Monday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   my_sn_g(monday$graphs$g3,      title = "Monday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   my_sn_g(monday$graphs$g4,      title = "Monday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend   
   my_sn_g(monday$graphs$g5,      title = "Monday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   
#Tuesday Graphs
   
  my_sn_g(tuesday$graphs$g1,     title = "Tuesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
  my_sn_g(tuesday$graphs$g2,     title = "Tuesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
  my_sn_g(tuesday$graphs$g3,     title = "Tuesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend  
  my_sn_g(tuesday$graphs$g4,     title = "Tuesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(tuesday$graphs$g5,     title = "Tuesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  
#Wednesday Graphs 
   
  my_sn_g(wednesday$graphs$g1,   title = "Wednesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g2,   title = "Wednesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g3,   title = "Wednesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g4,   title = "Wednesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g5,   title = "Wednesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend


  my_sn_g(thursday$graphs$g1,    title = "Thursday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g2,    title = "Thursday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g3,    title = "Thursday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g4,    title = "Thursday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g5,    title = "Thursday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  
#Plot With purrr::walk()
  #walk(.x = monday$graphs, .f = my_sn_g, title = "Monday");my_leg(role, color)
  #walk(.x = tuesday$graphs, .f = my_sn_g, title = "Tuesday");my_leg(role, color)
  #walk(.x =wednesday$graphs, .f = my_sn_g, title = "Wednesday");my_leg(role, color)
  #walk(.x = thursday$graphs, .f = my_sn_g, title = "Thursday");my_leg(role, color)
```


**Create Semester List**
```{r}
F15 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(temp)
```

##S16
```{r}
temp <- elmk %>% filter(semester == "S16")

mon <- temp %>% filter(night == "monday")
tue <- temp %>% filter(night == "tuesday")
wed <- temp %>% filter(night == "wednesday")
thu <- temp %>% filter(night == "thursday")

sem <- list(mon = mon, 
            tue = tue, 
            wed = wed, 
            thu = thu)

rm(mon);rm(tue);rm(wed);rm(thu)


```

**Summary**

```{r}


sem$mon <- group_by(sem$mon, survnum)
sem$tue <- group_by(sem$tue, survnum)
sem$wed <- group_by(sem$wed, survnum)
sem$thu <- group_by(sem$thu, survnum)

summarize(sem$mon, day = "mon", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$mon))*100)
summarize(sem$tue, day = "tue", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$tue))*100)
summarize(sem$wed, day = "wed", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$wed))*100)
summarize(sem$thu, day = "thu", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$thu))*100)

sem$mon <- ungroup(sem$mon)
sem$tue <- ungroup(sem$tue)
sem$wed <- ungroup(sem$wed)
sem$thu <- ungroup(sem$thu)

rm(sem)
```

**Monday**
```{r}

temp_night <- temp            %>% filter(night == "monday")
temp_att   <- staff_youth_att %>% mutate(night =  "monday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)


```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)





rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
monday <- list(edgelists = day, graphs = graphs)
rm(day);rm(graphs)
```


**Tuesday**
```{r}

temp_night <- temp            %>% filter(night == "tuesday")
temp_att   <- staff_youth_att %>% mutate(night =  "tuesday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
tuesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


**Wednesday**
```{r}

temp_night <- temp            %>% filter(night == "wednesday")
temp_att   <- staff_youth_att %>% mutate(night =  "wednesday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
wednesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


**Thursday**
```{r}

temp_night <- temp            %>% filter(night == "thursday")
temp_att   <- staff_youth_att %>% mutate(night =  "thursday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
thursday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


###Plot Graphs
```{r, warning = FALSE, fig.width = 20, fig.height=20}

#Set chart image
par(mfrow=c(4,5)) 

#Monday Graphs

   my_sn_g(monday$graphs$g1,      title = "Monday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
   my_sn_g(monday$graphs$g2,      title = "Monday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   my_sn_g(monday$graphs$g3,      title = "Monday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   my_sn_g(monday$graphs$g4,      title = "Monday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend   
   my_sn_g(monday$graphs$g5,      title = "Monday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   
#Tuesday Graphs
   
  my_sn_g(tuesday$graphs$g1,     title = "Tuesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
  my_sn_g(tuesday$graphs$g2,     title = "Tuesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
  my_sn_g(tuesday$graphs$g3,     title = "Tuesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend  
  my_sn_g(tuesday$graphs$g4,     title = "Tuesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(tuesday$graphs$g5,     title = "Tuesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  
#Wednesday Graphs 
   
  my_sn_g(wednesday$graphs$g1,   title = "Wednesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g2,   title = "Wednesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g3,   title = "Wednesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g4,   title = "Wednesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g5,   title = "Wednesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend


  my_sn_g(thursday$graphs$g1,    title = "Thursday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g2,    title = "Thursday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g3,    title = "Thursday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g4,    title = "Thursday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g5,    title = "Thursday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  
#Plot With purrr::walk()
  #walk(.x = monday$graphs, .f = my_sn_g, title = "Monday");my_leg(role, color)
  #walk(.x = tuesday$graphs, .f = my_sn_g, title = "Tuesday");my_leg(role, color)
  #walk(.x =wednesday$graphs, .f = my_sn_g, title = "Wednesday");my_leg(role, color)
  #walk(.x = thursday$graphs, .f = my_sn_g, title = "Thursday");my_leg(role, color)
```


**Create Semester List**
```{r}
S16 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(temp)
```


##F16
```{r}
temp <- elmk %>% filter(semester == "F16")

mon <- temp %>% filter(night == "monday")
tue <- temp %>% filter(night == "tuesday")
wed <- temp %>% filter(night == "wednesday")
thu <- temp %>% filter(night == "thursday")

sem <- list(mon = mon, 
            tue = tue, 
            wed = wed, 
            thu = thu)

rm(mon);rm(tue);rm(wed);rm(thu)


```

**Summary**
```{r}


sem$mon <- group_by(sem$mon, survnum)
sem$tue <- group_by(sem$tue, survnum)
sem$wed <- group_by(sem$wed, survnum)
sem$thu <- group_by(sem$thu, survnum)

summarize(sem$mon, day = "mon", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$mon))*100)
summarize(sem$tue, day = "tue", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$tue))*100)
summarize(sem$wed, day = "wed", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$wed))*100)
summarize(sem$thu, day = "thu", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$thu))*100)

sem$mon <- ungroup(sem$mon)
sem$tue <- ungroup(sem$tue)
sem$wed <- ungroup(sem$wed)
sem$thu <- ungroup(sem$thu)

rm(sem)
```

**Monday**
```{r}

temp_night <- temp            %>% filter(night == "monday")
temp_att   <- staff_youth_att %>% mutate(night =  "monday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)





rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
monday <- list(edgelists = day, graphs = graphs)
rm(day);rm(graphs)
```

**Tuesday**
```{r}

temp_night <- temp            %>% filter(night == "tuesday")
temp_att   <- staff_youth_att %>% mutate(night =  "tuesday")


#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute
                           
w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
tuesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


**Wednesday**
```{r}

temp_night <- temp            %>% filter(night == "wednesday")
temp_att   <- staff_youth_att %>% mutate(night =  "wednesday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
wednesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


**Thursday**
```{r}

temp_night <- temp            %>% filter(night == "thursday")
temp_att   <- staff_youth_att %>% mutate(night =  "thursday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
thursday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```

###Plot Graphs
```{r, warning = FALSE, fig.width = 20, fig.height=20}

#Set chart image
par(mfrow=c(4,5)) 

#Monday Graphs

   my_sn_g(monday$graphs$g1,      title = "Monday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
   my_sn_g(monday$graphs$g2,      title = "Monday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   my_sn_g(monday$graphs$g3,      title = "Monday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   my_sn_g(monday$graphs$g4,      title = "Monday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend   
   my_sn_g(monday$graphs$g5,      title = "Monday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   
#Tuesday Graphs
   
  my_sn_g(tuesday$graphs$g1,     title = "Tuesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
  my_sn_g(tuesday$graphs$g2,     title = "Tuesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
  my_sn_g(tuesday$graphs$g3,     title = "Tuesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend  
  my_sn_g(tuesday$graphs$g4,     title = "Tuesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(tuesday$graphs$g5,     title = "Tuesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  
#Wednesday Graphs 
   
  my_sn_g(wednesday$graphs$g1,   title = "Wednesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g2,   title = "Wednesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g3,   title = "Wednesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g4,   title = "Wednesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g5,   title = "Wednesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend


  my_sn_g(thursday$graphs$g1,    title = "Thursday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g2,    title = "Thursday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g3,    title = "Thursday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g4,    title = "Thursday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g5,    title = "Thursday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  
#Plot With purrr::walk()
  #walk(.x = monday$graphs, .f = my_sn_g, title = "Monday");my_leg(role, color)
  #walk(.x = tuesday$graphs, .f = my_sn_g, title = "Tuesday");my_leg(role, color)
  #walk(.x =wednesday$graphs, .f = my_sn_g, title = "Wednesday");my_leg(role, color)
  #walk(.x = thursday$graphs, .f = my_sn_g, title = "Thursday");my_leg(role, color)
```



**Create Semester List**
```{r}
F16 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(temp)
```


##S17
```{r}
temp <- elmk %>% filter(semester == "S17")

mon <- temp %>% filter(night == "monday")
tue <- temp %>% filter(night == "tuesday")
wed <- temp %>% filter(night == "wednesday")
thu <- temp %>% filter(night == "thursday")

sem <- list(mon = mon, 
            tue = tue, 
            wed = wed, 
            thu = thu)

rm(mon);rm(tue);rm(wed);rm(thu)


```

**Summary**

```{r}


sem$mon <- group_by(sem$mon, survnum)
sem$tue <- group_by(sem$tue, survnum)
sem$wed <- group_by(sem$wed, survnum)
sem$thu <- group_by(sem$thu, survnum)

summarize(sem$mon, day = "mon", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$mon))*100)
summarize(sem$tue, day = "tue", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$tue))*100)
summarize(sem$wed, day = "wed", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$wed))*100)
summarize(sem$thu, day = "thu", n = length(unique(Sender_Final_ID)), tie_count = sum(sn1, na.rm = TRUE), tie_prop = (tie_count/nrow(sem$thu))*100)

sem$mon <- ungroup(sem$mon)
sem$tue <- ungroup(sem$tue)
sem$wed <- ungroup(sem$wed)
sem$thu <- ungroup(sem$thu)

rm(sem)
```

**Monday**
```{r}

temp_night <- temp            %>% filter(night == "monday")
temp_att   <- staff_youth_att %>% mutate(night =  "monday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
monday <- list(edgelists = day, graphs = graphs)
rm(day);rm(graphs)
```


**Tuesday**
```{r}

temp_night <- temp            %>% filter(night == "tuesday")
temp_att   <- staff_youth_att %>% mutate(night =  "tuesday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates



#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
tuesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


**Wednesday**
```{r}

temp_night <- temp            %>% filter(night == "wednesday")
temp_att   <- staff_youth_att %>% mutate(night =  "wednesday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)


rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
wednesday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


**Thursday**
```{r}

temp_night <- temp            %>% filter(night == "thursday")
temp_att   <- staff_youth_att %>% mutate(night =  "thursday")

#Surv_1
surv_1 <- temp_night %>% 
  filter(survnum == 1) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates1 <- surv_1 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_1 <- surv_1 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 2
surv_2 <- temp_night %>% 
  filter(survnum == 2) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates2 <- surv_2 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_2 <- surv_2 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 3
surv_3 <- temp_night %>% 
  filter(survnum == 3) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates3 <- surv_3 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_3 <- surv_3 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 4
surv_4 <- temp_night %>% 
  filter(survnum == 4) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates4 <- surv_4 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_4 <- surv_4 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

#Surv 5
surv_5 <- temp_night %>% 
  filter(survnum == 5) %>% 
  mutate(Receiver_Final_ID = ifelse(is.na(sn1), NA, Receiver_Final_ID)) #%>% 
#Getting isolates
isolates5 <- surv_5 %>% 
  mutate(sn1 = ifelse(is.na(sn1), 0, sn1)) %>% 
  group_by(Sender_Final_ID) %>% 
  summarize(isolate = sum(sn1)) %>% 
  filter(isolate < 1) %>% 
  select(Sender_Final_ID)
surv_5 <- surv_5 %>% 
   select(Sender_Final_ID, Receiver_Final_ID) %>% filter(!(is.na(Receiver_Final_ID)))

day <- list(sur1 = surv_1, 
            sur2 = surv_2, 
            sur3 = surv_3, 
            sur4 = surv_4,
            sur5 = surv_5,
            iso1 = isolates1,
            iso2 = isolates2,
            iso3 = isolates3,
            iso4 = isolates4,
            iso5 = isolates5)

rm(surv_1);rm(surv_2);rm(surv_3);rm(surv_4);rm(surv_5)
rm(isolates1);rm(isolates2);rm(isolates3);rm(isolates4);rm(isolates5)

```

**General Graphs**
```{r, warning = FALSE}
#Convert to Matrices

sur1 <- as.matrix(day$sur1)
sur2 <- as.matrix(day$sur2)
sur3 <- as.matrix(day$sur3)
sur4 <- as.matrix(day$sur4)
sur5 <- as.matrix(day$sur5)


# Convert matrix to an igraph object

g1 <- graph.edgelist(sur1, directed = TRUE) + vertices(day$iso1$Sender_Final_ID) #Graph edgelist + Add Isolates
g2 <- graph.edgelist(sur2, directed = TRUE) + vertices(day$iso2$Sender_Final_ID) #Graph edgelist + Add Isolates
g3 <- graph.edgelist(sur3, directed = TRUE) + vertices(day$iso3$Sender_Final_ID) #Graph edgelist + Add Isolates
g4 <- graph.edgelist(sur4, directed = TRUE) + vertices(day$iso4$Sender_Final_ID) #Graph edgelist + Add Isolates
g5 <- graph.edgelist(sur5, directed = TRUE) + vertices(day$iso5$Sender_Final_ID) #Graph edgelist + Add Isolates




#Capture Roles, Nights & Colors

temp_att <- temp_att %>% 
  mutate(
         role1    = ifelse((!(is.na(role2)))     & (night2 == night), role2,     role1),
         night1   = ifelse((!(is.na(night2)))    & (night2 == night), night2,    night1),
         role_col = ifelse((!(is.na(role_col2))) & (night2 == night), role_col2, role_col)
         )

#Add staff Role Attribute  

V(g1)$role  <- temp_att$role1[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$role  <- temp_att$role1[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$role  <- temp_att$role1[match(V(g3)$name, temp_att$Final_ID)] 
V(g4)$role  <- temp_att$role1[match(V(g4)$name, temp_att$Final_ID)] 
V(g5)$role  <- temp_att$role1[match(V(g5)$name, temp_att$Final_ID)] 

#Add role colors

V(g1)$color <- temp_att$role_col[match(V(g1)$name, temp_att$Final_ID)] 
V(g2)$color <- temp_att$role_col[match(V(g2)$name, temp_att$Final_ID)] 
V(g3)$color <- temp_att$role_col[match(V(g3)$name, temp_att$Final_ID)]
V(g4)$color <- temp_att$role_col[match(V(g4)$name, temp_att$Final_ID)]
V(g5)$color <- temp_att$role_col[match(V(g5)$name, temp_att$Final_ID)]


#Add Edge weights - Match by edgelist rows Send/ Receive rows & temp_night Send/Receive rows. filter by survey.  

w <- left_join(rename(as_data_frame(as_edgelist(g1)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 1) #Match Weights
                           g1 <-  set_edge_attr(g1, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g2)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 2) #Match weights
                           g2 <-  set_edge_attr(g2, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g3)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 3) #Match weights
                           g3 <-  set_edge_attr(g3, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g4)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 4) #Match weights
                           g4 <-  set_edge_attr(g4, "weight", value = w$sn2) #Add edge attribute

w <- left_join(rename(as_data_frame(as_edgelist(g5)), Sender_Final_ID =V1, Receiver_Final_ID = V2), temp_night, by = c("Sender_Final_ID","Receiver_Final_ID")) %>% 
                               filter(survnum == 5) #Match weights
                           g5 <-  set_edge_attr(g5, "weight", value = w$sn2) #Add edge attribute

#Set graphs to list
graphs <- list(g1 = g1,g2 = g2, g3 = g3,g4 = g4, g5 = g5)





rm(g1); rm(g2); rm(g3); rm(g4); rm(g5)
rm(sur1);rm(sur2);rm(sur3);rm(sur4);rm(sur5)
rm(temp_att); rm(temp_night); rm(w)
```

**Create List**
```{r}
thursday <- list(edgelists = day, graphs = graphs)
rm(day); rm(graphs)
```


###Plot Graphs
```{r, warning = FALSE, fig.width = 20, fig.height=20}

#Set chart image
par(mfrow=c(4,5)) 

#Monday Graphs

   my_sn_g(monday$graphs$g1,      title = "Monday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
   my_sn_g(monday$graphs$g2,      title = "Monday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   my_sn_g(monday$graphs$g3,      title = "Monday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   my_sn_g(monday$graphs$g4,      title = "Monday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend   
   my_sn_g(monday$graphs$g5,      title = "Monday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
   
#Tuesday Graphs
   
  my_sn_g(tuesday$graphs$g1,     title = "Tuesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
  my_sn_g(tuesday$graphs$g2,     title = "Tuesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend 
  my_sn_g(tuesday$graphs$g3,     title = "Tuesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend  
  my_sn_g(tuesday$graphs$g4,     title = "Tuesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(tuesday$graphs$g5,     title = "Tuesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  
#Wednesday Graphs 
   
  my_sn_g(wednesday$graphs$g1,   title = "Wednesday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g2,   title = "Wednesday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g3,   title = "Wednesday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g4,   title = "Wednesday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(wednesday$graphs$g5,   title = "Wednesday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend


  my_sn_g(thursday$graphs$g1,    title = "Thursday - Week 1")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g2,    title = "Thursday - Week 3")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g3,    title = "Thursday - Week 6")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g4,    title = "Thursday - Week 9")  ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  my_sn_g(thursday$graphs$g5,    title = "Thursday - Week 11") ; my_leg(att = role, colors = color) #Social Network Graph ; Legend
  
#Plot With purrr::walk()
  #walk(.x = monday$graphs, .f = my_sn_g, title = "Monday");my_leg(role, color)
  #walk(.x = tuesday$graphs, .f = my_sn_g, title = "Tuesday");my_leg(role, color)
  #walk(.x =wednesday$graphs, .f = my_sn_g, title = "Wednesday");my_leg(role, color)
  #walk(.x = thursday$graphs, .f = my_sn_g, title = "Thursday");my_leg(role, color)
```


**Create Semester List**
```{r}
S17 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(temp)
```


#Combine Semesters to list
```{r}
ALL <- list(F15 = F15, S16 = S16, F16 = F16, S17 = S17)
rm(F15);rm(S16);rm(F16);rm(S17)
```

#Save All Networks to permanant RData File
```{r}
saveRDS(ALL, file="T:/Research folders/CCWTG/Data/MERGEALL/ALL_NETWORKS.RDS")
```


#Examine Cliques
##F15
```{r, warning = FALSE, fig.width = 20, fig.height=20, echo=FALSE}

#Monday
g1 <- ALL$F15$monday$graphs$g1
g2 <- ALL$F15$monday$graphs$g2
g3 <- ALL$F15$monday$graphs$g3
g4 <- ALL$F15$monday$graphs$g4
g5 <- ALL$F15$monday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

monday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)

#Tuesday
g1 <- ALL$F15$tuesday$graphs$g1
g2 <- ALL$F15$tuesday$graphs$g2
g3 <- ALL$F15$tuesday$graphs$g3
g4 <- ALL$F15$tuesday$graphs$g4
g5 <- ALL$F15$tuesday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

tuesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)


#Wednesday
g1 <- ALL$F15$wednesday$graphs$g1
g2 <- ALL$F15$wednesday$graphs$g2
g3 <- ALL$F15$wednesday$graphs$g3
g4 <- ALL$F15$wednesday$graphs$g4
g5 <- ALL$F15$wednesday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

wednesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)


#Thursday
g1 <- ALL$F15$thursday$graphs$g1
g2 <- ALL$F15$thursday$graphs$g2
g3 <- ALL$F15$thursday$graphs$g3
g4 <- ALL$F15$thursday$graphs$g4
g5 <- ALL$F15$thursday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

thursday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)

par(mfrow=c(5,4))
plot(monday$surv1, main =    "week 1 - Monday")
plot(tuesday$surv1, main =   "week 1 - Tuesday")
plot(wednesday$surv1, main = "week 1 - Wednesday")
plot(thursday$surv1, main =  "week 1 -Thursday")

#par(mfrow=c(4,1))
plot(monday$surv2, main =    "week 3 - Monday")
plot(tuesday$surv2, main =   "week 3 - Tuesday")
plot(wednesday$surv2, main = "week 3 - Wednesday")
plot(thursday$surv2, main =  "week 3 -Thursday")

#par(mfrow=c(4,1))
plot(monday$surv3, main =    "week 6 - Monday")
plot(tuesday$surv3, main =   "week 6 - Tuesday")
plot(wednesday$surv3, main = "week 6 - Wednesday")
plot(thursday$surv3, main =  "week 6 -Thursday")


#par(mfrow=c(4,1))
plot(monday$surv4, main =    "week 9 - Monday")
plot(tuesday$surv4, main =   "week 9 - Tuesday")
plot(wednesday$surv4, main = "week 9 - Wednesday")
plot(thursday$surv4, main =  "week 9 -Thursday")


#par(mfrow=c(4,1))
plot(monday$surv5, main =    "week 11 - Monday")
plot(tuesday$surv5, main =   "week 11 - Tuesday")
plot(wednesday$surv5, main = "week 11 - Wednesday")
plot(thursday$surv5, main =  "week 11 -Thursday")

F15 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(lc1)
```

##S16
```{r, warning = FALSE, fig.width = 20, fig.height=20, echo=FALSE}

#Monday
g1 <- ALL$S16$monday$graphs$g1
g2 <- ALL$S16$monday$graphs$g2
g3 <- ALL$S16$monday$graphs$g3
g4 <- ALL$S16$monday$graphs$g4
g5 <- ALL$S16$monday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

monday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)

#Tuesday
g1 <- ALL$S16$tuesday$graphs$g1
g2 <- ALL$S16$tuesday$graphs$g2
g3 <- ALL$S16$tuesday$graphs$g3
g4 <- ALL$S16$tuesday$graphs$g4
g5 <- ALL$S16$tuesday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

tuesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)


#Wednesday
g1 <- ALL$S16$wednesday$graphs$g1
g2 <- ALL$S16$wednesday$graphs$g2
g3 <- ALL$S16$wednesday$graphs$g3
g4 <- ALL$S16$wednesday$graphs$g4
g5 <- ALL$S16$wednesday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

wednesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)


#Thursday
g1 <- ALL$S16$thursday$graphs$g1
g2 <- ALL$S16$thursday$graphs$g2
g3 <- ALL$S16$thursday$graphs$g3
g4 <- ALL$S16$thursday$graphs$g4
g5 <- ALL$S16$thursday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

thursday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)

par(mfrow=c(5,4))
plot(monday$surv1, main =    "week 1 - Monday")
plot(tuesday$surv1, main =   "week 1 - Tuesday")
plot(wednesday$surv1, main = "week 1 - Wednesday")
plot(thursday$surv1, main =  "week 1 -Thursday")

#par(mfrow=c(4,1))
plot(monday$surv2, main =    "week 3 - Monday")
plot(tuesday$surv2, main =   "week 3 - Tuesday")
plot(wednesday$surv2, main = "week 3 - Wednesday")
plot(thursday$surv2, main =  "week 3 -Thursday")

#par(mfrow=c(4,1))
plot(monday$surv3, main =    "week 6 - Monday")
plot(tuesday$surv3, main =   "week 6 - Tuesday")
plot(wednesday$surv3, main = "week 6 - Wednesday")
plot(thursday$surv3, main =  "week 6 -Thursday")


#par(mfrow=c(4,1))
plot(monday$surv4, main =    "week 9 - Monday")
plot(tuesday$surv4, main =   "week 9 - Tuesday")
plot(wednesday$surv4, main = "week 9 - Wednesday")
plot(thursday$surv4, main =  "week 9 -Thursday")


#par(mfrow=c(4,1))
plot(monday$surv5, main =    "week 11 - Monday")
plot(tuesday$surv5, main =   "week 11 - Tuesday")
plot(wednesday$surv5, main = "week 11 - Wednesday")
plot(thursday$surv5, main =  "week 11 -Thursday")


S16<- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(lc1)
```



##F16
```{r, warning = FALSE, fig.width = 20, fig.height=20, echo=FALSE}

#Monday
g1 <- ALL$F16$monday$graphs$g1
g2 <- ALL$F16$monday$graphs$g2
g3 <- ALL$F16$monday$graphs$g3
g4 <- ALL$F16$monday$graphs$g4
g5 <- ALL$F16$monday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

monday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)

#Tuesday
g1 <- ALL$F16$tuesday$graphs$g1
g2 <- ALL$F16$tuesday$graphs$g2
g3 <- ALL$F16$tuesday$graphs$g3
g4 <- ALL$F16$tuesday$graphs$g4
g5 <- ALL$F16$tuesday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

tuesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)


#Wednesday
g1 <- ALL$F16$wednesday$graphs$g1
g2 <- ALL$F16$wednesday$graphs$g2
g3 <- ALL$F16$wednesday$graphs$g3
g4 <- ALL$F16$wednesday$graphs$g4
g5 <- ALL$F16$wednesday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

wednesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)


#Thursday
g1 <- ALL$F16$thursday$graphs$g1
g2 <- ALL$F16$thursday$graphs$g2
g3 <- ALL$F16$thursday$graphs$g3
g4 <- ALL$F16$thursday$graphs$g4
g5 <- ALL$F16$thursday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

thursday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)

par(mfrow=c(5,4))
plot(monday$surv1, main =    "week 1 - Monday")
plot(tuesday$surv1, main =   "week 1 - Tuesday")
plot(wednesday$surv1, main = "week 1 - Wednesday")
plot(thursday$surv1, main =  "week 1 -Thursday")

#par(mfrow=c(4,1))
plot(monday$surv2, main =    "week 3 - Monday")
plot(tuesday$surv2, main =   "week 3 - Tuesday")
plot(wednesday$surv2, main = "week 3 - Wednesday")
plot(thursday$surv2, main =  "week 3 -Thursday")

#par(mfrow=c(4,1))
plot(monday$surv3, main =    "week 6 - Monday")
plot(tuesday$surv3, main =   "week 6 - Tuesday")
plot(wednesday$surv3, main = "week 6 - Wednesday")
plot(thursday$surv3, main =  "week 6 -Thursday")


#par(mfrow=c(4,1))
plot(monday$surv4, main =    "week 9 - Monday")
plot(tuesday$surv4, main =   "week 9 - Tuesday")
plot(wednesday$surv4, main = "week 9 - Wednesday")
plot(thursday$surv4, main =  "week 9 -Thursday")


#par(mfrow=c(4,1))
plot(monday$surv5, main =    "week 11 - Monday")
plot(tuesday$surv5, main =   "week 11 - Tuesday")
plot(wednesday$surv5, main = "week 11 - Wednesday")
plot(thursday$surv5, main =  "week 11 -Thursday")

F16 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(lc1)
```




##S17
```{r, warning = FALSE, fig.width = 20, fig.height=20, echo=FALSE}

#Monday
g1 <- ALL$S17$monday$graphs$g1
g2 <- ALL$S17$monday$graphs$g2
g3 <- ALL$S17$monday$graphs$g3
g4 <- ALL$S17$monday$graphs$g4
g5 <- ALL$S17$monday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

monday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)

#Tuesday
g1 <- ALL$S17$tuesday$graphs$g1
g2 <- ALL$S17$tuesday$graphs$g2
g3 <- ALL$S17$tuesday$graphs$g3
g4 <- ALL$S17$tuesday$graphs$g4
g5 <- ALL$S17$tuesday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

tuesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)


#Wednesday
g1 <- ALL$S17$wednesday$graphs$g1
g2 <- ALL$S17$wednesday$graphs$g2
g3 <- ALL$S17$wednesday$graphs$g3
g4 <- ALL$S17$wednesday$graphs$g4
g5 <- ALL$S17$wednesday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

wednesday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)


#Thursday
g1 <- ALL$S17$thursday$graphs$g1
g2 <- ALL$S17$thursday$graphs$g2
g3 <- ALL$S17$thursday$graphs$g3
g4 <- ALL$S17$thursday$graphs$g4
g5 <- ALL$S17$thursday$graphs$g5


lc1 <- largest_cliques(g1) 
gs1 <- as.undirected(induced.subgraph(g1, lc1[[1]]))

lc1 <- largest_cliques(g2) 
gs2 <- as.undirected(induced.subgraph(g2, lc1[[1]]))

lc1 <- largest_cliques(g3) 
gs3 <- as.undirected(induced.subgraph(g3, lc1[[1]]))

lc1 <- largest_cliques(g4) 
gs4 <- as.undirected(induced.subgraph(g4, lc1[[1]]))

lc1 <- largest_cliques(g5) 
gs5 <- as.undirected(induced.subgraph(g5, lc1[[1]]))

thursday <- list(surv1 = gs1, surv2 = gs2, surv3 = gs3, surv4 = gs4, surv5 = gs5)

rm(g1);rm(g2);rm(g3);rm(g4);rm(g5);
rm(gs1);rm(gs2);rm(gs3);rm(gs4);rm(gs5)

par(mfrow=c(5,4))
plot(monday$surv1, main =    "week 1 - Monday")
plot(tuesday$surv1, main =   "week 1 - Tuesday")
plot(wednesday$surv1, main = "week 1 - Wednesday")
plot(thursday$surv1, main =  "week 1 -Thursday")

#par(mfrow=c(4,1))
plot(monday$surv2, main =    "week 3 - Monday")
plot(tuesday$surv2, main =   "week 3 - Tuesday")
plot(wednesday$surv2, main = "week 3 - Wednesday")
plot(thursday$surv2, main =  "week 3 -Thursday")

#par(mfrow=c(4,1))
plot(monday$surv3, main =    "week 6 - Monday")
plot(tuesday$surv3, main =   "week 6 - Tuesday")
plot(wednesday$surv3, main = "week 6 - Wednesday")
plot(thursday$surv3, main =  "week 6 -Thursday")


#par(mfrow=c(4,1))
plot(monday$surv4, main =    "week 9 - Monday")
plot(tuesday$surv4, main =   "week 9 - Tuesday")
plot(wednesday$surv4, main = "week 9 - Wednesday")
plot(thursday$surv4, main =  "week 9 -Thursday")


#par(mfrow=c(4,1))
plot(monday$surv5, main =    "week 11 - Monday")
plot(tuesday$surv5, main =   "week 11 - Tuesday")
plot(wednesday$surv5, main = "week 11 - Wednesday")
plot(thursday$surv5, main =  "week 11 -Thursday")

S17 <- list(monday = monday, tuesday = tuesday, wednesday = wednesday, thursday = thursday)
rm(monday);rm(tuesday);rm(wednesday);rm(thursday)
rm(lc1)
```
##Combine Cliques
```{r}
cliques <- list(F15 = F15, S16 = S16, F16 = F16, S17 = S17)
rm(F15);rm(S16);rm(F16);rm(S17)
```


#Histograms
##Tie count
###F15
```{r}

dow <- "monday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$monday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$monday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$monday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$monday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$monday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesm <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidym <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))


###TUESDAY
dow <- "tuesday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$tuesday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$tuesday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$tuesday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$tuesday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$tuesday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiest <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyt <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))



###Wednesday
dow <- "wednesday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$wednesday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$wednesday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$wednesday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$wednesday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$wednesday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesw <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyw <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))



###Wednesday
dow <- "thursday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$thursday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$thursday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$thursday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$thursday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F15$thursday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesr <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyr <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))


ties.tidy <- rbind(
                    ties.tidym,
                    ties.tidyt,
                    ties.tidyw,
                    ties.tidyr
                   )


ties.wide <- rbind(
                    tiesm,
                    tiest,
                    tiesw,
                    tiesr
                  )


wideF15 <- ties.wide


check <- ties.tidy %>% 
  group_by(Final_ID) %>% 
  summarize(check = sum(surv)) %>% 
  filter(check > 45)

check

tidy.ties <- list(F15 = ties.tidy)

sent <- ties.tidy %>% 
  filter(type == "sent") %>% 
  mutate(sent = nties) %>%
  select(-nties, -type)

received <- ties.tidy %>% 
  filter(type == "received") %>% 
  mutate(received = nties) %>%
  select(-nties, -type)

all <- ties.tidy %>% 
  filter(type == "all") %>% 
  mutate(all = nties) %>%
  select(-nties, -type)

ties.wide <- sent %>% 
  merge(received, by = c("Final_ID", "surv", "night")) %>% 
  merge(all, by = c("Final_ID", "surv", "night")) %>% 
  select(-role.x, -role.y)

ties.wide <- ties.wide %>% 
  group_by(Final_ID, surv, night) %>% 
  slice(1)

write_csv(ties.wide, "C:/Users/ndyetz/Desktop/thao_rel.csv", na = "")

#?write_csv



ties.tidy <- ties.tidy %>% 
  arrange(Final_ID, surv) 





rm(ties.wide)
#?spread

#rm(ties1);rm(ties2);rm(ties3);rm(ties4);rm(ties5)
#rm(temp);rm(temp_surv)
#rm(ties.tidym);rm(ties.tidyt);rm(ties.tidyw);rm(ties.tidyr)


```

##Graphs
```{r, fig.width = 15, fig.height = 15}

ties.tidy %>% 
filter(surv == 1 | surv == 2) %>% 
ggplot(aes(x = nties,     fill = factor(role)))  + geom_histogram(binwidth = 1) + facet_grid(type + night ~ surv) + theme_classic()

ties.tidy %>% 
filter(surv > 2) %>% 
ggplot(aes(x = nties,     fill = factor(role)))  + geom_histogram(binwidth = 5) + facet_grid(type + night ~ surv) + theme_classic()

```



###S16
```{r}

dow <- "monday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$monday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$monday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$monday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$monday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$monday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesm <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidym <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))


###TUESDAY
dow <- "tuesday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$tuesday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$tuesday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$tuesday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$tuesday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$tuesday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiest <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyt <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))



###Wednesday
dow <- "wednesday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$wednesday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$wednesday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$wednesday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$wednesday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$wednesday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesw <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyw <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))



###Wednesday
dow <- "thursday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$thursday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$thursday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$thursday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$thursday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S16$thursday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesr <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyr <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))


ties.tidy <- rbind(
                    ties.tidym,
                    ties.tidyt,
                    ties.tidyw,
                    ties.tidyr
                   )


ties.wide <- rbind(
                    tiesm,
                    tiest,
                    tiesw,
                    tiesr
                  )

wideS16 <- ties.wide


check <- ties.tidy %>% 
  group_by(Final_ID) %>% 
  summarize(check = sum(surv)) %>% 
  filter(check > 45)

check

tidy.ties <- list(S16 = ties.tidy)

sent <- ties.tidy %>% 
  filter(type == "sent") %>% 
  mutate(sent = nties) %>%
  select(-nties, -type)

received <- ties.tidy %>% 
  filter(type == "received") %>% 
  mutate(received = nties) %>%
  select(-nties, -type)

all <- ties.tidy %>% 
  filter(type == "all") %>% 
  mutate(all = nties) %>%
  select(-nties, -type)

ties.wide <- sent %>% 
  merge(received, by = c("Final_ID", "surv", "night")) %>% 
  merge(all, by = c("Final_ID", "surv", "night")) %>% 
  select(-role.x, -role.y)

ties.wide <- ties.wide %>% 
  group_by(Final_ID, surv, night) %>% 
  slice(1)

write_csv(ties.wide, "C:/Users/ndyetz/Desktop/thao_relS16.csv", na = "")

#?write_csv



ties.tidy <- ties.tidy %>% 
  arrange(Final_ID, surv) 





rm(ties.wide)
#?spread

#rm(ties1);rm(ties2);rm(ties3);rm(ties4);rm(ties5)
#rm(temp);rm(temp_surv)
#rm(ties.tidym);rm(ties.tidyt);rm(ties.tidyw);rm(ties.tidyr)


```

###F16
```{r}

dow <- "monday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$monday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$monday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$monday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$monday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$monday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesm <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidym <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))


###TUESDAY
dow <- "tuesday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$tuesday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$tuesday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$tuesday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$tuesday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$tuesday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiest <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyt <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))



###Wednesday
dow <- "wednesday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$wednesday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$wednesday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$wednesday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$wednesday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$wednesday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesw <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyw <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))



###Wednesday
dow <- "thursday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$thursday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$thursday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$thursday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$thursday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$F16$thursday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesr <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyr <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))


ties.tidy <- rbind(
                    ties.tidym,
                    ties.tidyt,
                    ties.tidyw,
                    ties.tidyr
                   )


ties.wide <- rbind(
                    tiesm,
                    tiest,
                    tiesw,
                    tiesr
                  )

wideF16 <- ties.wide


check <- ties.tidy %>% 
  group_by(Final_ID) %>% 
  summarize(check = sum(surv)) %>% 
  filter(check > 45)

check

tidy.ties <- list(F16 = ties.tidy)

sent <- ties.tidy %>% 
  filter(type == "sent") %>% 
  mutate(sent = nties) %>%
  select(-nties, -type)

received <- ties.tidy %>% 
  filter(type == "received") %>% 
  mutate(received = nties) %>%
  select(-nties, -type)

all <- ties.tidy %>% 
  filter(type == "all") %>% 
  mutate(all = nties) %>%
  select(-nties, -type)

ties.wide <- sent %>% 
  merge(received, by = c("Final_ID", "surv", "night")) %>% 
  merge(all, by = c("Final_ID", "surv", "night")) %>% 
  select(-role.x, -role.y)

ties.wide <- ties.wide %>% 
  group_by(Final_ID, surv, night) %>% 
  slice(1)

write_csv(ties.wide, "C:/Users/ndyetz/Desktop/thao_relF16.csv", na = "")

#?write_csv



ties.tidy <- ties.tidy %>% 
  arrange(Final_ID, surv) 





rm(ties.wide)
#?spread

#rm(ties1);rm(ties2);rm(ties3);rm(ties4);rm(ties5)
#rm(temp);rm(temp_surv)
#rm(ties.tidym);rm(ties.tidyt);rm(ties.tidyw);rm(ties.tidyr)


```

###S17
```{r}

dow <- "monday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$monday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$monday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$monday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$monday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$monday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesm <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidym <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))


###TUESDAY
dow <- "tuesday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$tuesday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$tuesday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$tuesday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$tuesday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$tuesday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiest <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyt <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))



###Wednesday
dow <- "wednesday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$wednesday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$wednesday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$wednesday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$wednesday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$wednesday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesw <- ties %>% 
  mutate(night = dow)

#tidy data
ties.tidyw <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))



###Wednesday
dow <- "thursday"

#survey 1
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$thursday$graphs$g1), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 



ties1 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 1) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 2
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$thursday$graphs$g2), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties2 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 2) %>% 
  select(Final_ID, role, surv, sent, received, all)

#Survey 3
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$thursday$graphs$g3), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties3 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 3) %>% 
  select(Final_ID, role, surv, sent, received, all)



#Survey 4
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$thursday$graphs$g4), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties4 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 4) %>% 
  select(Final_ID, role, surv, sent, received, all)


#Survey 5
temp_surv <- as_data_frame(as.matrix(as_adj(ALL$S17$thursday$graphs$g5), rownames = TRUE), rownames = NA)


temp <- data.frame(matrix(nrow= nrow(temp_surv) , ncol= 0)) #blank dataframe
temp$sent     <- as_data_frame(as.matrix(rowSums(temp_surv)))
temp$received <- as_data_frame(as.matrix(colSums(temp_surv)))
temp$all      <- temp$sent + temp$received

temp <- as.matrix(temp)

rownames(temp) <- seq(nrow(temp)) #remove rownames

temp_surv <- temp_surv %>% 
  tibble::rownames_to_column() %>% 
  select(Final_ID = "rowname", everything())

temp_surv <- cbind(temp_surv, temp)

role <- staff_youth_att %>% 
  mutate(
         night = if_else((!(is.na(night2)) & night2 == dow), night2, night1),
         role  = if_else((!(is.na(night2)) & night2 == dow), role2,  role1)) %>% 
  filter(night == dow) %>% 
  select(Final_ID, role) 

ties5 <- left_join(temp_surv, role, by = "Final_ID") %>% 
  mutate(surv = 5) %>% 
  select(Final_ID, role, surv, sent, received, all)


ties <- rbind(ties1,ties2, ties3, ties4, ties5)

tiesr <- ties %>% 
  mutate(night = dow)


#tidy data
ties.tidyr <- ties %>%
  select(Final_ID, role, surv, sent, received, all) %>% 
  gather(key, nties, -Final_ID, -surv, -role) %>%
  separate(key, "type") %>% 
  mutate(night = factor(dow))


ties.tidy <- rbind(
                    ties.tidym,
                    ties.tidyt,
                    ties.tidyw,
                    ties.tidyr
                   )


ties.wide <- rbind(
                    tiesm,
                    tiest,
                    tiesw,
                    tiesr
                  )

wideS17 <- ties.wide


check <- ties.tidy %>% 
  group_by(Final_ID) %>% 
  summarize(check = sum(surv)) %>% 
  filter(check > 45)

check

tidy.ties <- list(S17 = ties.tidy)

sent <- ties.tidy %>% 
  filter(type == "sent") %>% 
  mutate(sent = nties) %>%
  select(-nties, -type)

received <- ties.tidy %>% 
  filter(type == "received") %>% 
  mutate(received = nties) %>%
  select(-nties, -type)

all <- ties.tidy %>% 
  filter(type == "all") %>% 
  mutate(all = nties) %>%
  select(-nties, -type)

ties.wide <- sent %>% 
  merge(received, by = c("Final_ID", "surv", "night")) %>% 
  merge(all, by = c("Final_ID", "surv", "night")) %>% 
  select(-role.x, -role.y)

ties.wide <- ties.wide %>% 
  group_by(Final_ID, surv, night) %>% 
  slice(1)

ties.wide <- ties.wide %>% 
  filter(!is.na(role))

write_csv(ties.wide, "C:/Users/ndyetz/Desktop/thao_relS17.csv", na = "")

#?write_csv



ties.tidy <- ties.tidy %>% 
  arrange(Final_ID, surv) 







rm(ties.wide)
#?spread

#rm(ties1);rm(ties2);rm(ties3);rm(ties4);rm(ties5)
#rm(temp);rm(temp_surv)
#rm(ties.tidym);rm(ties.tidyt);rm(ties.tidyw);rm(ties.tidyr)


```

##Combine Semesters
```{r}

ties.wide <- rbind(
                    wideF15,
                    wideS16,
                    wideF16,
                    wideS17
                  )

ties.wide <- ties.wide %>% 
  filter(!is.na(role))


ties.wide.m <- ties.wide %>%
  filter(role != "mentee") %>% 
  group_by(Final_ID, surv, night) %>% 
  slice(1)

#Have no idea why, but the youth data gets coerced into a list...Need to convert back into a data frame
ties.wide.m <- as_data_frame(ties.wide.m)


ties.wide.y <- ties.wide %>% 
  filter(role == "mentee") %>% 
  group_by(Final_ID, surv) %>% 
  slice(1)

#Have no idea why, but the youth data gets coerced into a list...Need to convert back into a data frame
ties.wide.y <- as_data_frame(ties.wide.y)

ties.wide <- rbind(
                   ties.wide.m,
                   ties.wide.y
                  )

ties.wide <- ties.wide %>%
  arrange(Final_ID, surv)
```



#Network checks
```{r}


#Check for those that have MORE than 5 time points (No mentees should be here)
check <- ties.wide %>% 
#  filter(role == "mentee") %>% 
  group_by(Final_ID) %>% 
  summarise(count = n()) %>% 
  filter(count > 5)

#Check mentors that have more than 5 surveys to make sure they're not on the same night
check_nights <- ties.wide %>% 
  right_join(check, by = "Final_ID") %>% 
  arrange(Final_ID, night)


#Check how many people have LESS than 5 timepoints (Participants that dropped or came into the network late)
check2 <- ties.wide %>% 
  group_by(Final_ID) %>% 
  summarise(count = n()) %>% 
  filter(count < 5)


```

#Write_CSV for thao
```{r}

write_csv(ties.wide, "C:/Users/ndyetz/Desktop/thao_rel.csv", na = "")

```

